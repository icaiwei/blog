(window.webpackJsonp=window.webpackJsonp||[]).push([[259],{2937:function(n,s,e){"use strict";e.r(s);var a=e(0),t=Object(a.a)({},(function(){var n=this,s=n._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("h2",{attrs:{id:"原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#原理"}},[n._v("#")]),n._v(" 原理")]),n._v(" "),s("p",[n._v("创建图形用"),s("code",[n._v("Put")]),n._v("方法，编辑图形用添加新图形，删除原图形")]),n._v(" "),s("h2",{attrs:{id:"替换layer-text"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#替换layer-text"}},[n._v("#")]),n._v(" 替换layer text")]),n._v(" "),s("div",{staticClass:"language-vbscript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("'\n'The example below demonstrates the element manipulations \n'on a fabrication layer text. \n'It changes the text string of the incoming element 'orgTextObj’ \n'to 'newTextString’ by creating a new text element. \n'The new element is placed in the design. The original element is deleted.\n'==================================================================== \nSub FabTextReplace  (orgTextObj,newTextString)\n\nDim docObj,resultMess\nDim newTextObj\n\n'collect document object\nSet docObj = GetLicensedDoc(app)\nIf (docObj Is Nothing) Then Exit Sub\n\n'if the incoming element is empty then exit \nIf (orgTextObj Is Nothing) Then Exit Sub\n\n'create the new text element \nIf (app.LockServer(True)) Then\n Set newTextObj = docObj.PutFabricationLayerText( newTextString, _ \n                   \torgTextObj.PositionX ,orgTextObj.PositionY, _ \n\t\t\t\t\torgTextObj.Type,orgTextObj.Side,orgTextObj.Format.Height,_ \n\t\t\t\t\torgTextObj.Format.Orientation,orgTextObj.Format.PenWidth, _\n                   \torgTextObj.Format.Font,orgTextObj.Format.Attributes, _  \n\t\t\t\t\torgTextObj.Format.HorizontalJust,orgTextObj.Format.VerticalJust, _ \n\t\t\t\t\torgTextObj.Component,epcbUnitCurrent,epcbAngleUnitDegrees)\n\n If (Err) Then \n  Call app.Gui.StatusBarText(\"An error occured while creating new text : \" + _ \n                              vbNewLine + Err.Description,epcbStatusFieldError)\n  app.UnlockServer(False)\n  Exit Sub\n Else \n  'delete the original text\n  orgTextObj.Delete\n  If (Err) Then \n   Call app.Gui.StatusBarText(\"Could not delete original text : \" + _ \n                              vbNewLine + Err.Description,epcbStatusFieldError)\n   app.UnlockServer(False)\n   Exit Sub\n  End if\n  resultMess = \"Fabrication text change was successfull\"\n\n  'select the new text object and fit it on the board\n  newTextObj.selected = True\n  docObj.ActiveView.SetExtentsToSelection\n\n  'Update status bar\n  Call app.Gui.StatusBarText(resultMess,epcbStatusField1)\n End If\n app.UnlockServer(True)\nEnd if \n\nEnd Sub\n'\n'Testing code for the sample\n'\nDim app \nSet app = GetObject(,\"MGCPCB.Application\")\nDim textObj \n\n'Code to retrieve or create a fabrication text object goes here\n  '....\n  '....\n\n'Execute text replacement on the textObject (uncomment the line below)\n'Call FabTextReplace  (textObj,\"Text String was replaced\") \n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br"),s("span",{staticClass:"line-number"},[n._v("18")]),s("br"),s("span",{staticClass:"line-number"},[n._v("19")]),s("br"),s("span",{staticClass:"line-number"},[n._v("20")]),s("br"),s("span",{staticClass:"line-number"},[n._v("21")]),s("br"),s("span",{staticClass:"line-number"},[n._v("22")]),s("br"),s("span",{staticClass:"line-number"},[n._v("23")]),s("br"),s("span",{staticClass:"line-number"},[n._v("24")]),s("br"),s("span",{staticClass:"line-number"},[n._v("25")]),s("br"),s("span",{staticClass:"line-number"},[n._v("26")]),s("br"),s("span",{staticClass:"line-number"},[n._v("27")]),s("br"),s("span",{staticClass:"line-number"},[n._v("28")]),s("br"),s("span",{staticClass:"line-number"},[n._v("29")]),s("br"),s("span",{staticClass:"line-number"},[n._v("30")]),s("br"),s("span",{staticClass:"line-number"},[n._v("31")]),s("br"),s("span",{staticClass:"line-number"},[n._v("32")]),s("br"),s("span",{staticClass:"line-number"},[n._v("33")]),s("br"),s("span",{staticClass:"line-number"},[n._v("34")]),s("br"),s("span",{staticClass:"line-number"},[n._v("35")]),s("br"),s("span",{staticClass:"line-number"},[n._v("36")]),s("br"),s("span",{staticClass:"line-number"},[n._v("37")]),s("br"),s("span",{staticClass:"line-number"},[n._v("38")]),s("br"),s("span",{staticClass:"line-number"},[n._v("39")]),s("br"),s("span",{staticClass:"line-number"},[n._v("40")]),s("br"),s("span",{staticClass:"line-number"},[n._v("41")]),s("br"),s("span",{staticClass:"line-number"},[n._v("42")]),s("br"),s("span",{staticClass:"line-number"},[n._v("43")]),s("br"),s("span",{staticClass:"line-number"},[n._v("44")]),s("br"),s("span",{staticClass:"line-number"},[n._v("45")]),s("br"),s("span",{staticClass:"line-number"},[n._v("46")]),s("br"),s("span",{staticClass:"line-number"},[n._v("47")]),s("br"),s("span",{staticClass:"line-number"},[n._v("48")]),s("br"),s("span",{staticClass:"line-number"},[n._v("49")]),s("br"),s("span",{staticClass:"line-number"},[n._v("50")]),s("br"),s("span",{staticClass:"line-number"},[n._v("51")]),s("br"),s("span",{staticClass:"line-number"},[n._v("52")]),s("br"),s("span",{staticClass:"line-number"},[n._v("53")]),s("br"),s("span",{staticClass:"line-number"},[n._v("54")]),s("br"),s("span",{staticClass:"line-number"},[n._v("55")]),s("br"),s("span",{staticClass:"line-number"},[n._v("56")]),s("br"),s("span",{staticClass:"line-number"},[n._v("57")]),s("br"),s("span",{staticClass:"line-number"},[n._v("58")]),s("br"),s("span",{staticClass:"line-number"},[n._v("59")]),s("br"),s("span",{staticClass:"line-number"},[n._v("60")]),s("br"),s("span",{staticClass:"line-number"},[n._v("61")]),s("br"),s("span",{staticClass:"line-number"},[n._v("62")]),s("br"),s("span",{staticClass:"line-number"},[n._v("63")]),s("br"),s("span",{staticClass:"line-number"},[n._v("64")]),s("br"),s("span",{staticClass:"line-number"},[n._v("65")]),s("br"),s("span",{staticClass:"line-number"},[n._v("66")]),s("br"),s("span",{staticClass:"line-number"},[n._v("67")]),s("br"),s("span",{staticClass:"line-number"},[n._v("68")]),s("br"),s("span",{staticClass:"line-number"},[n._v("69")]),s("br")])]),s("h2",{attrs:{id:"移动user-layer图形"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#移动user-layer图形"}},[n._v("#")]),n._v(" 移动user layer图形")]),n._v(" "),s("div",{staticClass:"language-vbscript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("' The example below moves all user layer graphics objects on \n' user layer 'Reserved_Area’ with a deltaX and deltaY\n' (graphics inside the components is not included\n'\n\nFunction  Move_UserGfx(gfxObj,deltaX,deltaY)\n' \n=========================================================================\n====\n' Description : Move a graphics object. This will recreate the graphics \nobject \n'               in its new location\n'\n' Parameters:\n'    - deltaX : Displacement in X\n'    - deltaY : Displacement in Y\n' \n' Return values 1: If success\n'               -1: If failure \n'\n' \n=========================================================================\n====\non error resume next\nDim retValue:retValue = 0\n\nDim docObj,resultMess,geomObj,pntsArr,i,numPoints,newObj,layerObj \n\n' collect document object\nSet docObj = GetLicensedDoc(app)\nIf (docObj Is Nothing) Then Exit Function\n\n' collect the points array of the user layer gfx\nSet geomObj = gfxObj.Geometry\npntsArr = geomObj.PointsArray\nnumPoints = UBound(pntsArr,2) +1\n\n' displace the points array in x and y\nFor i = 0 To numPoints - 1\n pntsArr(0,i) = pntsArr(0,i) + deltaX\n pntsArr(1,i) = pntsArr(1,i) + deltaY\nNext\n\n' recreate the element in the document\nSet layerObj = docObj.UserLayers.Item(gfxObj.LayerName)\nSet newObj = docObj.PutUserLayerGfx( layerObj,geomObj.LineWidth, _ \n                                     numPoints,pntsArr, _ \n                                     geomObj.DisplayFilled,gfxObj.Component)\n\nIf (Err) Then \n  Call app.Gui.StatusBarText(\"An error occured while creating a user layer \ngraphics element: \" + _ \n                              vbNewLine + Err.Description,epcbStatusFieldError)\n  Move_UserGfx = -1\nElse \n  ' delete the original object\n  gfxObj.Delete   \n  Move_UserGfx = 1\nEnd if  \n\nEnd Function\n\nSub Move_UserLayer(layerName,deltaX,deltaY)\n' \n=========================================================================\n====\n' Description : Move a user layer \n'               in its new location\n'\n' Parameters:\n'    - layerName : the name of the user layer to move\n'    - deltaX    : Displacement in X\n'    - deltaY    : Displacement in Y\n' \n' Return values 1: If success\n'               -1: If failure \n' \n=========================================================================\n====\n\nDim docObj,resultMess,gfxColl,i,gfxObj,retVal\n\n' collect document object\nSet docObj = GetLicensedDoc(app)\nIf (docObj Is Nothing) Then Exit Sub\n\n' Collect the user layer graphics elements\nIf (app.LockServer(True) = True ) Then\n Set gfxColl = docObj.UserLayerGfxs(epcbSelectAll,layerName,False) \n\n If (Err) Then \n   Call app.Gui.StatusBarText(\"An error occured while collecting user \nlayer graphics: \" + _ \n                              vbNewLine + Err.Description,epcbStatusFieldError)\n   app.UnlockServer False\n   Exit Sub\n Else \n\n  ' Translate the elements \n  ' \n  For i =1 To gfxColl.Count\n   Set gfxObj = gfxColl.Item(i)\n   retVal = Move_UserGfx(gfxObj,deltaX,deltaY)\n  Next\n\n  ' unlock the server\n  app.UnlockServer True\n\nEnd if \n\n\n\nEnd if\n\nEnd Sub\n'\n' Testing code for the sample\n'\nDim app \nSet app = GetObject(,\"MGCPCB.Application\")\nCall Move_UserLayer(\"Reserved Area\",100,100)\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br"),s("span",{staticClass:"line-number"},[n._v("18")]),s("br"),s("span",{staticClass:"line-number"},[n._v("19")]),s("br"),s("span",{staticClass:"line-number"},[n._v("20")]),s("br"),s("span",{staticClass:"line-number"},[n._v("21")]),s("br"),s("span",{staticClass:"line-number"},[n._v("22")]),s("br"),s("span",{staticClass:"line-number"},[n._v("23")]),s("br"),s("span",{staticClass:"line-number"},[n._v("24")]),s("br"),s("span",{staticClass:"line-number"},[n._v("25")]),s("br"),s("span",{staticClass:"line-number"},[n._v("26")]),s("br"),s("span",{staticClass:"line-number"},[n._v("27")]),s("br"),s("span",{staticClass:"line-number"},[n._v("28")]),s("br"),s("span",{staticClass:"line-number"},[n._v("29")]),s("br"),s("span",{staticClass:"line-number"},[n._v("30")]),s("br"),s("span",{staticClass:"line-number"},[n._v("31")]),s("br"),s("span",{staticClass:"line-number"},[n._v("32")]),s("br"),s("span",{staticClass:"line-number"},[n._v("33")]),s("br"),s("span",{staticClass:"line-number"},[n._v("34")]),s("br"),s("span",{staticClass:"line-number"},[n._v("35")]),s("br"),s("span",{staticClass:"line-number"},[n._v("36")]),s("br"),s("span",{staticClass:"line-number"},[n._v("37")]),s("br"),s("span",{staticClass:"line-number"},[n._v("38")]),s("br"),s("span",{staticClass:"line-number"},[n._v("39")]),s("br"),s("span",{staticClass:"line-number"},[n._v("40")]),s("br"),s("span",{staticClass:"line-number"},[n._v("41")]),s("br"),s("span",{staticClass:"line-number"},[n._v("42")]),s("br"),s("span",{staticClass:"line-number"},[n._v("43")]),s("br"),s("span",{staticClass:"line-number"},[n._v("44")]),s("br"),s("span",{staticClass:"line-number"},[n._v("45")]),s("br"),s("span",{staticClass:"line-number"},[n._v("46")]),s("br"),s("span",{staticClass:"line-number"},[n._v("47")]),s("br"),s("span",{staticClass:"line-number"},[n._v("48")]),s("br"),s("span",{staticClass:"line-number"},[n._v("49")]),s("br"),s("span",{staticClass:"line-number"},[n._v("50")]),s("br"),s("span",{staticClass:"line-number"},[n._v("51")]),s("br"),s("span",{staticClass:"line-number"},[n._v("52")]),s("br"),s("span",{staticClass:"line-number"},[n._v("53")]),s("br"),s("span",{staticClass:"line-number"},[n._v("54")]),s("br"),s("span",{staticClass:"line-number"},[n._v("55")]),s("br"),s("span",{staticClass:"line-number"},[n._v("56")]),s("br"),s("span",{staticClass:"line-number"},[n._v("57")]),s("br"),s("span",{staticClass:"line-number"},[n._v("58")]),s("br"),s("span",{staticClass:"line-number"},[n._v("59")]),s("br"),s("span",{staticClass:"line-number"},[n._v("60")]),s("br"),s("span",{staticClass:"line-number"},[n._v("61")]),s("br"),s("span",{staticClass:"line-number"},[n._v("62")]),s("br"),s("span",{staticClass:"line-number"},[n._v("63")]),s("br"),s("span",{staticClass:"line-number"},[n._v("64")]),s("br"),s("span",{staticClass:"line-number"},[n._v("65")]),s("br"),s("span",{staticClass:"line-number"},[n._v("66")]),s("br"),s("span",{staticClass:"line-number"},[n._v("67")]),s("br"),s("span",{staticClass:"line-number"},[n._v("68")]),s("br"),s("span",{staticClass:"line-number"},[n._v("69")]),s("br"),s("span",{staticClass:"line-number"},[n._v("70")]),s("br"),s("span",{staticClass:"line-number"},[n._v("71")]),s("br"),s("span",{staticClass:"line-number"},[n._v("72")]),s("br"),s("span",{staticClass:"line-number"},[n._v("73")]),s("br"),s("span",{staticClass:"line-number"},[n._v("74")]),s("br"),s("span",{staticClass:"line-number"},[n._v("75")]),s("br"),s("span",{staticClass:"line-number"},[n._v("76")]),s("br"),s("span",{staticClass:"line-number"},[n._v("77")]),s("br"),s("span",{staticClass:"line-number"},[n._v("78")]),s("br"),s("span",{staticClass:"line-number"},[n._v("79")]),s("br"),s("span",{staticClass:"line-number"},[n._v("80")]),s("br"),s("span",{staticClass:"line-number"},[n._v("81")]),s("br"),s("span",{staticClass:"line-number"},[n._v("82")]),s("br"),s("span",{staticClass:"line-number"},[n._v("83")]),s("br"),s("span",{staticClass:"line-number"},[n._v("84")]),s("br"),s("span",{staticClass:"line-number"},[n._v("85")]),s("br"),s("span",{staticClass:"line-number"},[n._v("86")]),s("br"),s("span",{staticClass:"line-number"},[n._v("87")]),s("br"),s("span",{staticClass:"line-number"},[n._v("88")]),s("br"),s("span",{staticClass:"line-number"},[n._v("89")]),s("br"),s("span",{staticClass:"line-number"},[n._v("90")]),s("br"),s("span",{staticClass:"line-number"},[n._v("91")]),s("br"),s("span",{staticClass:"line-number"},[n._v("92")]),s("br"),s("span",{staticClass:"line-number"},[n._v("93")]),s("br"),s("span",{staticClass:"line-number"},[n._v("94")]),s("br"),s("span",{staticClass:"line-number"},[n._v("95")]),s("br"),s("span",{staticClass:"line-number"},[n._v("96")]),s("br"),s("span",{staticClass:"line-number"},[n._v("97")]),s("br"),s("span",{staticClass:"line-number"},[n._v("98")]),s("br"),s("span",{staticClass:"line-number"},[n._v("99")]),s("br"),s("span",{staticClass:"line-number"},[n._v("100")]),s("br"),s("span",{staticClass:"line-number"},[n._v("101")]),s("br"),s("span",{staticClass:"line-number"},[n._v("102")]),s("br"),s("span",{staticClass:"line-number"},[n._v("103")]),s("br"),s("span",{staticClass:"line-number"},[n._v("104")]),s("br"),s("span",{staticClass:"line-number"},[n._v("105")]),s("br"),s("span",{staticClass:"line-number"},[n._v("106")]),s("br"),s("span",{staticClass:"line-number"},[n._v("107")]),s("br"),s("span",{staticClass:"line-number"},[n._v("108")]),s("br"),s("span",{staticClass:"line-number"},[n._v("109")]),s("br"),s("span",{staticClass:"line-number"},[n._v("110")]),s("br"),s("span",{staticClass:"line-number"},[n._v("111")]),s("br"),s("span",{staticClass:"line-number"},[n._v("112")]),s("br"),s("span",{staticClass:"line-number"},[n._v("113")]),s("br"),s("span",{staticClass:"line-number"},[n._v("114")]),s("br"),s("span",{staticClass:"line-number"},[n._v("115")]),s("br"),s("span",{staticClass:"line-number"},[n._v("116")]),s("br"),s("span",{staticClass:"line-number"},[n._v("117")]),s("br"),s("span",{staticClass:"line-number"},[n._v("118")]),s("br"),s("span",{staticClass:"line-number"},[n._v("119")]),s("br"),s("span",{staticClass:"line-number"},[n._v("120")]),s("br"),s("span",{staticClass:"line-number"},[n._v("121")]),s("br")])])])}),[],!1,null,null,null);s.default=t.exports}}]);